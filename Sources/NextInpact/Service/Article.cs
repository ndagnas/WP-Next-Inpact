//*******************************************************************************************************************************
// DEBUT DU FICHIER
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// Nom           : Article.cs
// Auteur        : Nicolas Dagnas
// Description   : Implémentation de l'objet Article
// Créé le       : 23/03/2015
// Modifié le    : 21/05/2015
//*******************************************************************************************************************************

//-------------------------------------------------------------------------------------------------------------------------------
#region Using directives
//-------------------------------------------------------------------------------------------------------------------------------
using System;
using System.Globalization;
//-------------------------------------------------------------------------------------------------------------------------------
#endregion
//-------------------------------------------------------------------------------------------------------------------------------

//*******************************************************************************************************************************
// Début du bloc "NextInpact.Service"
//*******************************************************************************************************************************
namespace NextInpact.Service
	{

	//   ###   ####   #####  #   ###   #      #####
	//  #   #  #   #    #    #  #   #  #      #    
	//  #####  ####     #    #  #      #      ###  
	//  #   #  #   #    #    #  #   #  #      #    
	//  #   #  #   #    #    #   ###   #####  #####

	//***************************************************************************************************************************
	// Classe Article
	//***************************************************************************************************************************
	#region // Déclaration et Implémentation de l'Objet
	//---------------------------------------------------------------------------------------------------------------------------
	/// <summary>
	/// Définit un article.
	/// </summary>
	//---------------------------------------------------------------------------------------------------------------------------
	public class Article
		{
		//***********************************************************************************************************************
		/// <summary>
		/// Initialise une nouvelle instance de l'objet <b>Article</b>.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Article () {}
		//***********************************************************************************************************************
		
		//***********************************************************************************************************************
		/// <summary>
		/// Convertit la chaine en objet <b>Article</b>.
		/// </summary>
		/// <param name="Value">Chaine à convertir.</param>
		/// <returns>Objet <b>Article</b>.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static Article Parse ( string Uri )
			{
			//-------------------------------------------------------------------------------------------------------------------
			#region // Implémentation de la Procédure
			//-------------------------------------------------------------------------------------------------------------------

			//-------------------------------------------------------------------------------------------------------------------
			try { return Article.Parse ( new Uri ( Uri ) ); } catch {}
			
			return Article.Empty;
			//-------------------------------------------------------------------------------------------------------------------

			//-------------------------------------------------------------------------------------------------------------------
			#endregion
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Convertit la chaine en objet <b>Article</b>.
		/// </summary>
		/// <param name="Value">Chaine à convertir.</param>
		/// <returns>Objet <b>Article</b>.</returns>
		//-----------------------------------------------------------------------------------------------------------------------
		public static Article Parse ( Uri Uri )
			{
			//-------------------------------------------------------------------------------------------------------------------
			#region // Implémentation de la Procédure
			//-------------------------------------------------------------------------------------------------------------------

			//-------------------------------------------------------------------------------------------------------------------
			if ( Uri != null && Uri.IsAbsoluteUri )
				{
				//---------------------------------------------------------------------------------------------------------------
				string Original = Uri.OriginalString;

				if ( Original.Contains ( ".nextinpact.com/news/"       ) )
					return new Article () { Uri = Uri, Type = ArticleType.Article };

				if ( Original.Contains ( ".nextinpact.com/test/"       ) )
					return new Article () { Uri = Uri, Type = ArticleType.Test    };

				if ( Original.Contains ( ".nextinpact.com/dossier/"    ) )
					return new Article () { Uri = Uri, Type = ArticleType.Folder  };

				if ( Original.Contains ( ".nextinpact.com/rechercher?" ) )
					return new Article () { Uri = Uri, Type = ArticleType.Search  };
				
				return new Article () { Uri = Uri, Type = ArticleType.Other };
				//---------------------------------------------------------------------------------------------------------------
				}
			//-------------------------------------------------------------------------------------------------------------------

			//-------------------------------------------------------------------------------------------------------------------
			else { return new Article () { Uri = Uri, Type = ArticleType.Other }; }
			//-------------------------------------------------------------------------------------------------------------------
			
			//-------------------------------------------------------------------------------------------------------------------
			#endregion
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		
		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'identifiant marque page.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public string BookmarkID
			{
			//-------------------------------------------------------------------------------------------------------------------
			get { return ( this.Uri == null ) ? string.Empty : this.Uri.OriginalString; }
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************
		
		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'objet marque page associé.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Bookmark Bookmark
			{
			//-------------------------------------------------------------------------------------------------------------------
			get { return new Bookmark () { Uri = this.Uri.OriginalString, Title = this.Title }; }
			//-------------------------------------------------------------------------------------------------------------------
			}
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens un objet Article non initialisé.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public static Article Empty { get { return new Article (); } }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Indique si l'objet courant est initialisé ou pas.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public bool IsEmpty { get { return this.Uri == null; } }
		//***********************************************************************************************************************
		
		//***********************************************************************************************************************
		/// <summary>
		/// Indique si l'atticle a été marqué.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public bool IsMarked { get; set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens ou définit le titre de l'article.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public string Title { get; set; }
		//***********************************************************************************************************************
		
		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens ou définit le titre de l'article.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public ArticleType Type { get; set; }
		//***********************************************************************************************************************

		//***********************************************************************************************************************
		/// <summary>
		/// Obtiens l'url de l'article.
		/// </summary>
		//-----------------------------------------------------------------------------------------------------------------------
		public Uri Uri { get; set; }
		//***********************************************************************************************************************
		}
	//---------------------------------------------------------------------------------------------------------------------------
	#endregion
	//***************************************************************************************************************************

	} // Fin du namespace "NextInpact.Service"
//*******************************************************************************************************************************

//*******************************************************************************************************************************
// FIN DU FICHIER
//*******************************************************************************************************************************
